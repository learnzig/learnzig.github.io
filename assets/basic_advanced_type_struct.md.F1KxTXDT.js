import{_ as s,o as n,c as a,R as l}from"./chunks/framework.XiqD54nH.js";const u=JSON.parse('{"title":"结构体","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"basic/advanced_type/struct.md","filePath":"basic/advanced_type/struct.md","lastUpdated":1700370012000}'),p={name:"basic/advanced_type/struct.md"},o=l(`<h1 id="结构体" tabindex="-1">结构体 <a class="header-anchor" href="#结构体" aria-label="Permalink to &quot;结构体&quot;">​</a></h1><blockquote><p>在 zig 中，类型是一等公民！</p></blockquote><p>结构体本身是一个高级的数据结构，用于将多个数据表示为一个整体。</p><h2 id="基本语法" tabindex="-1">基本语法 <a class="header-anchor" href="#基本语法" aria-label="Permalink to &quot;基本语法&quot;">​</a></h2><p>结构体的组成：</p><ul><li>首部关键字 <code>struct</code></li><li>和变量定义一样的结构体名字</li><li>多个字段</li><li>方法</li><li>多个声明</li></ul><p>以下是一个简短的结构体声明：</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-06Mha" id="tab-lQ6lG5r" checked="checked"><label for="tab-lQ6lG5r">default</label><input type="radio" name="group-06Mha" id="tab-MmhAfp9"><label for="tab-MmhAfp9">more</label></div><div class="blocks"><div class="language-zig vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">zig</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">Circle</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">radius</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">PI</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">f16</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">3.14</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">pub</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">init</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">radius</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">) </span><span style="color:#FFAB70;">Circle</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">Circle</span><span style="color:#E1E4E8;">{ .</span><span style="color:#FFAB70;">radius</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">radius</span><span style="color:#E1E4E8;"> };</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">area</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">self</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">*</span><span style="color:#FFAB70;">Circle</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">f16</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">@as</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">f16</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">@floatFromInt</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">self</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">radius</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">self</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">radius</span><span style="color:#E1E4E8;">)) </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">PI</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">Circle</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">radius</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">PI</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">f16</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">3.14</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">pub</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">init</span><span style="color:#24292E;">(</span><span style="color:#E36209;">radius</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">) </span><span style="color:#E36209;">Circle</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#E36209;">Circle</span><span style="color:#24292E;">{ .</span><span style="color:#E36209;">radius</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">radius</span><span style="color:#24292E;"> };</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">area</span><span style="color:#24292E;">(</span><span style="color:#E36209;">self</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">*</span><span style="color:#E36209;">Circle</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">f16</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">@as</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">f16</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">@floatFromInt</span><span style="color:#24292E;">(</span><span style="color:#E36209;">self</span><span style="color:#24292E;">.</span><span style="color:#E36209;">radius</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#E36209;">self</span><span style="color:#24292E;">.</span><span style="color:#E36209;">radius</span><span style="color:#24292E;">)) </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#E36209;">PI</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">};</span></span></code></pre></div><div class="language-zig vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zig</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">std</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">@import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;std&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">Circle</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">radius</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">PI</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">f16</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">3.14</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">pub</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">init</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">radius</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">) </span><span style="color:#FFAB70;">Circle</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">Circle</span><span style="color:#E1E4E8;">{ .</span><span style="color:#FFAB70;">radius</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">radius</span><span style="color:#E1E4E8;"> };</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">area</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">self</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">*</span><span style="color:#FFAB70;">Circle</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">f16</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">@as</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">f16</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">@floatFromInt</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">self</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">radius</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">self</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">radius</span><span style="color:#E1E4E8;">)) </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">PI</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">pub</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">radius</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">circle</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">Circle</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">init</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">radius</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">std</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">debug</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;The area of a circle with radius {} is {d:.2}</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">, .{ </span><span style="color:#FFAB70;">radius</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">circle</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">area</span><span style="color:#E1E4E8;">() });</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">std</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">@import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;std&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">Circle</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">radius</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">PI</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">f16</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">3.14</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">pub</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">init</span><span style="color:#24292E;">(</span><span style="color:#E36209;">radius</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">) </span><span style="color:#E36209;">Circle</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#E36209;">Circle</span><span style="color:#24292E;">{ .</span><span style="color:#E36209;">radius</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">radius</span><span style="color:#24292E;"> };</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">area</span><span style="color:#24292E;">(</span><span style="color:#E36209;">self</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">*</span><span style="color:#E36209;">Circle</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">f16</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">@as</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">f16</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">@floatFromInt</span><span style="color:#24292E;">(</span><span style="color:#E36209;">self</span><span style="color:#24292E;">.</span><span style="color:#E36209;">radius</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#E36209;">self</span><span style="color:#24292E;">.</span><span style="color:#E36209;">radius</span><span style="color:#24292E;">)) </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#E36209;">PI</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">pub</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">var</span><span style="color:#24292E;"> </span><span style="color:#E36209;">radius</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">u8</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">5</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">var</span><span style="color:#24292E;"> </span><span style="color:#E36209;">circle</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">Circle</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">init</span><span style="color:#24292E;">(</span><span style="color:#E36209;">radius</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">std</span><span style="color:#24292E;">.</span><span style="color:#E36209;">debug</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;The area of a circle with radius {} is {d:.2}</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">, .{ </span><span style="color:#E36209;">radius</span><span style="color:#24292E;">, </span><span style="color:#E36209;">circle</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">area</span><span style="color:#24292E;">() });</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div></div></div><p>上方的代码的内容：</p><ul><li>定义了一个结构体 <code>Circle</code>，用于表示一个圆</li><li>包含字段 <code>radius</code></li><li>一个声明 <code>PI</code></li><li>包含两个方法 <code>init</code> 和 <code>area</code></li></ul><details class="details custom-block"><summary>更复杂的例子</summary><p>下面是一个日常会用到的一个结构体例子，系统账号管理的使用：</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-eeJ22" id="tab-Fox3ZNu" checked="checked"><label for="tab-Fox3ZNu">default</label><input type="radio" name="group-eeJ22" id="tab-PjQ0UcQ"><label for="tab-PjQ0UcQ">more</label></div><div class="blocks"><div class="language-zig vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">zig</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">User</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">userName</span><span style="color:#E1E4E8;">: []</span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">password</span><span style="color:#E1E4E8;">: []</span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">email</span><span style="color:#E1E4E8;">: []</span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">active</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">bool</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">pub</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">writer</span><span style="color:#E1E4E8;"> = </span><span style="color:#9ECBFF;">&quot;learnzig&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">pub</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">init</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">userName</span><span style="color:#E1E4E8;">: []</span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">password</span><span style="color:#E1E4E8;">: []</span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">email</span><span style="color:#E1E4E8;">: []</span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">active</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">bool</span><span style="color:#E1E4E8;">) </span><span style="color:#FFAB70;">User</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">User</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">            .</span><span style="color:#FFAB70;">userName</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">userName</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">            .</span><span style="color:#FFAB70;">password</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">password</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">            .</span><span style="color:#FFAB70;">email</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">email</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">            .</span><span style="color:#FFAB70;">active</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">active</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        };</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">pub</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">self</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">*</span><span style="color:#FFAB70;">User</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">std</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">debug</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">\\\\username: {s}</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">\\\\password: {s}</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">\\\\email: {s}</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">\\\\active: {}</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">\\\\</span></span>
<span class="line"><span style="color:#E1E4E8;">        , .{</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#FFAB70;">self</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">userName</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#FFAB70;">self</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">password</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#FFAB70;">self</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">email</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#FFAB70;">self</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">active</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        });</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">User</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">userName</span><span style="color:#24292E;">: []</span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">password</span><span style="color:#24292E;">: []</span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">email</span><span style="color:#24292E;">: []</span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">active</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">bool</span><span style="color:#24292E;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">pub</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">writer</span><span style="color:#24292E;"> = </span><span style="color:#032F62;">&quot;learnzig&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">pub</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">init</span><span style="color:#24292E;">(</span><span style="color:#E36209;">userName</span><span style="color:#24292E;">: []</span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">, </span><span style="color:#E36209;">password</span><span style="color:#24292E;">: []</span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">, </span><span style="color:#E36209;">email</span><span style="color:#24292E;">: []</span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">, </span><span style="color:#E36209;">active</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">bool</span><span style="color:#24292E;">) </span><span style="color:#E36209;">User</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#E36209;">User</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">            .</span><span style="color:#E36209;">userName</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">userName</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            .</span><span style="color:#E36209;">password</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">password</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            .</span><span style="color:#E36209;">email</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">email</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            .</span><span style="color:#E36209;">active</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">active</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        };</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">pub</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#E36209;">self</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">*</span><span style="color:#E36209;">User</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">std</span><span style="color:#24292E;">.</span><span style="color:#E36209;">debug</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">\\\\username: {s}</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">\\\\password: {s}</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">\\\\email: {s}</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">\\\\active: {}</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">\\\\</span></span>
<span class="line"><span style="color:#24292E;">        , .{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">self</span><span style="color:#24292E;">.</span><span style="color:#E36209;">userName</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">self</span><span style="color:#24292E;">.</span><span style="color:#E36209;">password</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">self</span><span style="color:#24292E;">.</span><span style="color:#E36209;">email</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">self</span><span style="color:#24292E;">.</span><span style="color:#E36209;">active</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        });</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">};</span></span></code></pre></div><div class="language-zig vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zig</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">std</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">@import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;std&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">gpa</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">std</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">heap</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">GeneralPurposeAllocator</span><span style="color:#E1E4E8;">(.{}){};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">User</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">userName</span><span style="color:#E1E4E8;">: []</span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">password</span><span style="color:#E1E4E8;">: []</span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">email</span><span style="color:#E1E4E8;">: []</span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">active</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">bool</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">pub</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">writer</span><span style="color:#E1E4E8;"> = </span><span style="color:#9ECBFF;">&quot;learnzig&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">pub</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">init</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">userName</span><span style="color:#E1E4E8;">: []</span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">password</span><span style="color:#E1E4E8;">: []</span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">email</span><span style="color:#E1E4E8;">: []</span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">active</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">bool</span><span style="color:#E1E4E8;">) </span><span style="color:#FFAB70;">User</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">User</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">            .</span><span style="color:#FFAB70;">userName</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">userName</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">            .</span><span style="color:#FFAB70;">password</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">password</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">            .</span><span style="color:#FFAB70;">email</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">email</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">            .</span><span style="color:#FFAB70;">active</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">active</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        };</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">pub</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">self</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">*</span><span style="color:#FFAB70;">User</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">std</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">debug</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">\\\\username: {s}</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">\\\\password: {s}</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">\\\\email: {s}</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">\\\\active: {}</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">\\\\</span></span>
<span class="line"><span style="color:#E1E4E8;">        , .{</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#FFAB70;">self</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">userName</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#FFAB70;">self</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">password</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#FFAB70;">self</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">email</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#FFAB70;">self</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">active</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        });</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">name</span><span style="color:#E1E4E8;"> = </span><span style="color:#9ECBFF;">&quot;xiaoming&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">passwd</span><span style="color:#E1E4E8;"> = </span><span style="color:#9ECBFF;">&quot;123456&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">mail</span><span style="color:#E1E4E8;"> = </span><span style="color:#9ECBFF;">&quot;123456@qq.com&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">pub</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">!void</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// var username = [_]8{};</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">allocator</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">gpa</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">allocator</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">defer</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">deinit_status</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">gpa</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">deinit</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//fail test; can&#39;t try in defer as defer is executed after we return</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">deinit_status</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> .</span><span style="color:#FFAB70;">leak</span><span style="color:#E1E4E8;">) </span><span style="color:#FFAB70;">std</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">testing</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">false</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">@panic</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;TEST FAIL&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">username</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">allocator</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">alloc</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">defer</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">allocator</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">free</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">username</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">@memset</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">username</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">@memcpy</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">username</span><span style="color:#E1E4E8;">[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">..</span><span style="color:#FFAB70;">name</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">len</span><span style="color:#E1E4E8;">], </span><span style="color:#FFAB70;">name</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">password</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">allocator</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">alloc</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">defer</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">allocator</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">free</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">password</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">@memset</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">password</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">@memcpy</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">password</span><span style="color:#E1E4E8;">[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">..</span><span style="color:#FFAB70;">passwd</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">len</span><span style="color:#E1E4E8;">], </span><span style="color:#FFAB70;">passwd</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">email</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">allocator</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">alloc</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">defer</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">allocator</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">free</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">email</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">@memset</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">email</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">@memcpy</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">email</span><span style="color:#E1E4E8;">[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">..</span><span style="color:#FFAB70;">mail</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">len</span><span style="color:#E1E4E8;">], </span><span style="color:#FFAB70;">mail</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">user</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">User</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">init</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">username</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">password</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">email</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">true</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">user</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">std</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">@import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;std&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">var</span><span style="color:#24292E;"> </span><span style="color:#E36209;">gpa</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">std</span><span style="color:#24292E;">.</span><span style="color:#E36209;">heap</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">GeneralPurposeAllocator</span><span style="color:#24292E;">(.{}){};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">User</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">userName</span><span style="color:#24292E;">: []</span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">password</span><span style="color:#24292E;">: []</span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">email</span><span style="color:#24292E;">: []</span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">active</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">bool</span><span style="color:#24292E;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">pub</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">writer</span><span style="color:#24292E;"> = </span><span style="color:#032F62;">&quot;learnzig&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">pub</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">init</span><span style="color:#24292E;">(</span><span style="color:#E36209;">userName</span><span style="color:#24292E;">: []</span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">, </span><span style="color:#E36209;">password</span><span style="color:#24292E;">: []</span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">, </span><span style="color:#E36209;">email</span><span style="color:#24292E;">: []</span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">, </span><span style="color:#E36209;">active</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">bool</span><span style="color:#24292E;">) </span><span style="color:#E36209;">User</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#E36209;">User</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">            .</span><span style="color:#E36209;">userName</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">userName</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            .</span><span style="color:#E36209;">password</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">password</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            .</span><span style="color:#E36209;">email</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">email</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            .</span><span style="color:#E36209;">active</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">active</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        };</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">pub</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#E36209;">self</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">*</span><span style="color:#E36209;">User</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">std</span><span style="color:#24292E;">.</span><span style="color:#E36209;">debug</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">\\\\username: {s}</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">\\\\password: {s}</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">\\\\email: {s}</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">\\\\active: {}</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">\\\\</span></span>
<span class="line"><span style="color:#24292E;">        , .{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">self</span><span style="color:#24292E;">.</span><span style="color:#E36209;">userName</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">self</span><span style="color:#24292E;">.</span><span style="color:#E36209;">password</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">self</span><span style="color:#24292E;">.</span><span style="color:#E36209;">email</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">self</span><span style="color:#24292E;">.</span><span style="color:#E36209;">active</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        });</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">name</span><span style="color:#24292E;"> = </span><span style="color:#032F62;">&quot;xiaoming&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">passwd</span><span style="color:#24292E;"> = </span><span style="color:#032F62;">&quot;123456&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">mail</span><span style="color:#24292E;"> = </span><span style="color:#032F62;">&quot;123456@qq.com&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">pub</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">!void</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// var username = [_]8{};</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">allocator</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">gpa</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">allocator</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">defer</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">deinit_status</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">gpa</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">deinit</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//fail test; can&#39;t try in defer as defer is executed after we return</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">deinit_status</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> .</span><span style="color:#E36209;">leak</span><span style="color:#24292E;">) </span><span style="color:#E36209;">std</span><span style="color:#24292E;">.</span><span style="color:#E36209;">testing</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">false</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">@panic</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;TEST FAIL&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">username</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#E36209;">allocator</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">alloc</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">20</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">defer</span><span style="color:#24292E;"> </span><span style="color:#E36209;">allocator</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">free</span><span style="color:#24292E;">(</span><span style="color:#E36209;">username</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">@memset</span><span style="color:#24292E;">(</span><span style="color:#E36209;">username</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">@memcpy</span><span style="color:#24292E;">(</span><span style="color:#E36209;">username</span><span style="color:#24292E;">[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">..</span><span style="color:#E36209;">name</span><span style="color:#24292E;">.</span><span style="color:#E36209;">len</span><span style="color:#24292E;">], </span><span style="color:#E36209;">name</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">password</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#E36209;">allocator</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">alloc</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">20</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">defer</span><span style="color:#24292E;"> </span><span style="color:#E36209;">allocator</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">free</span><span style="color:#24292E;">(</span><span style="color:#E36209;">password</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">@memset</span><span style="color:#24292E;">(</span><span style="color:#E36209;">password</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">@memcpy</span><span style="color:#24292E;">(</span><span style="color:#E36209;">password</span><span style="color:#24292E;">[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">..</span><span style="color:#E36209;">passwd</span><span style="color:#24292E;">.</span><span style="color:#E36209;">len</span><span style="color:#24292E;">], </span><span style="color:#E36209;">passwd</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">email</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#E36209;">allocator</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">alloc</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">20</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">defer</span><span style="color:#24292E;"> </span><span style="color:#E36209;">allocator</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">free</span><span style="color:#24292E;">(</span><span style="color:#E36209;">email</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">@memset</span><span style="color:#24292E;">(</span><span style="color:#E36209;">email</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">@memcpy</span><span style="color:#24292E;">(</span><span style="color:#E36209;">email</span><span style="color:#24292E;">[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">..</span><span style="color:#E36209;">mail</span><span style="color:#24292E;">.</span><span style="color:#E36209;">len</span><span style="color:#24292E;">], </span><span style="color:#E36209;">mail</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">var</span><span style="color:#24292E;"> </span><span style="color:#E36209;">user</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">User</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">init</span><span style="color:#24292E;">(</span><span style="color:#E36209;">username</span><span style="color:#24292E;">, </span><span style="color:#E36209;">password</span><span style="color:#24292E;">, </span><span style="color:#E36209;">email</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">true</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">user</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>在以上的代码中，我们使用了内存分配的功能，并且使用了切片和多行字符串，以及 <code>defer</code> 语法（在当前作用域的末尾执行语句）。</p></div></div></details><div class="info custom-block"><p class="custom-block-title">🅿️ 提示</p><p>值得注意的是，结构体的方法除了使用 <code>.</code> 语法来使用外，和其他的函数没有任何区别！这意味着你可以在任何你用普通函数的地方使用结构体的方法。</p></div><h2 id="自动推断" tabindex="-1">自动推断 <a class="header-anchor" href="#自动推断" aria-label="Permalink to &quot;自动推断&quot;">​</a></h2><p>zig 在使用结构体的时候还支持省略结构体类型，只要能让 zig 编译器推断出类型即可，例如：</p><div class="language-zig vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zig</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">Point</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> { </span><span style="color:#FFAB70;">x</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">i32</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">y</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">i32</span><span style="color:#E1E4E8;"> };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">pt</span><span style="color:#E1E4E8;">: </span><span style="color:#FFAB70;">Point</span><span style="color:#E1E4E8;"> = .{</span></span>
<span class="line"><span style="color:#E1E4E8;">    .</span><span style="color:#FFAB70;">x</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">13</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    .</span><span style="color:#FFAB70;">y</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">67</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">Point</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> { </span><span style="color:#E36209;">x</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">i32</span><span style="color:#24292E;">, </span><span style="color:#E36209;">y</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">i32</span><span style="color:#24292E;"> };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">var</span><span style="color:#24292E;"> </span><span style="color:#E36209;">pt</span><span style="color:#24292E;">: </span><span style="color:#E36209;">Point</span><span style="color:#24292E;"> = .{</span></span>
<span class="line"><span style="color:#24292E;">    .</span><span style="color:#E36209;">x</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">13</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    .</span><span style="color:#E36209;">y</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">67</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">};</span></span></code></pre></div><h2 id="泛型实现" tabindex="-1">泛型实现 <a class="header-anchor" href="#泛型实现" aria-label="Permalink to &quot;泛型实现&quot;">​</a></h2><p>依托于“类型是 zig 的一等公民”，我们可以很容易的实现泛型。</p><p>此处仅仅是简单提及一下该特性，后续我们会专门讲解泛型这一个利器！</p><p>以下是一个链表的类型实现：</p><div class="language-zig vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zig</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">LinkedList</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">comptime</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">T</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">type</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">type</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">pub</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">Node</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#FFAB70;">prev</span><span style="color:#E1E4E8;">: ?</span><span style="color:#F97583;">*</span><span style="color:#FFAB70;">Node</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#FFAB70;">next</span><span style="color:#E1E4E8;">: ?</span><span style="color:#F97583;">*</span><span style="color:#FFAB70;">Node</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#FFAB70;">data</span><span style="color:#E1E4E8;">: </span><span style="color:#FFAB70;">T</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">first</span><span style="color:#E1E4E8;">: ?</span><span style="color:#F97583;">*</span><span style="color:#FFAB70;">Node</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">last</span><span style="color:#E1E4E8;">:  ?</span><span style="color:#F97583;">*</span><span style="color:#FFAB70;">Node</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">len</span><span style="color:#E1E4E8;">:   </span><span style="color:#F97583;">usize</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    };</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">LinkedList</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">comptime</span><span style="color:#24292E;"> </span><span style="color:#E36209;">T</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">type</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">type</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">pub</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">Node</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">prev</span><span style="color:#24292E;">: ?</span><span style="color:#D73A49;">*</span><span style="color:#E36209;">Node</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">next</span><span style="color:#24292E;">: ?</span><span style="color:#D73A49;">*</span><span style="color:#E36209;">Node</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">data</span><span style="color:#24292E;">: </span><span style="color:#E36209;">T</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">first</span><span style="color:#24292E;">: ?</span><span style="color:#D73A49;">*</span><span style="color:#E36209;">Node</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">last</span><span style="color:#24292E;">:  ?</span><span style="color:#D73A49;">*</span><span style="color:#E36209;">Node</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">len</span><span style="color:#24292E;">:   </span><span style="color:#D73A49;">usize</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    };</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">🅿️ 提示</p><p>当然这种操作不局限于声明变量，你在函数中也可以使用（当编译器无法完成推断时，它会给出一个完整的堆栈跟踪）！</p></div><h2 id="字段默认值" tabindex="-1">字段默认值 <a class="header-anchor" href="#字段默认值" aria-label="Permalink to &quot;字段默认值&quot;">​</a></h2><p>结构体允许使用默认值，只需要在定义结构体的时候声明默认值即可：</p><div class="language-zig vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zig</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">Foo</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">a</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">i32</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">1234</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">b</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">i32</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">x</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">Foo</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    .</span><span style="color:#FFAB70;">b</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">Foo</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">a</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">i32</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">1234</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">b</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">i32</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">x</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">Foo</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    .</span><span style="color:#E36209;">b</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">5</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">};</span></span></code></pre></div><h2 id="空结构体" tabindex="-1">空结构体 <a class="header-anchor" href="#空结构体" aria-label="Permalink to &quot;空结构体&quot;">​</a></h2><p>你还可以使用空结构体，具体如下：</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-P5Uvi" id="tab-4UmWDX2" checked="checked"><label for="tab-4UmWDX2">default</label><input type="radio" name="group-P5Uvi" id="tab-VpVUhpi"><label for="tab-VpVUhpi">more</label></div><div class="blocks"><div class="language-zig vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">zig</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">Empty</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// const PI = 3.14;</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">Empty</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// const PI = 3.14;</span></span>
<span class="line"><span style="color:#24292E;">};</span></span></code></pre></div><div class="language-zig vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zig</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">std</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">@import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;std&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">Empty</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// const PI = 3.14;</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">pub</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">std</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">debug</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;{}</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">, .{</span><span style="color:#79B8FF;">@sizeOf</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Empty</span><span style="color:#E1E4E8;">)});</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">std</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">@import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;std&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">Empty</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// const PI = 3.14;</span></span>
<span class="line"><span style="color:#24292E;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">pub</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">std</span><span style="color:#24292E;">.</span><span style="color:#E36209;">debug</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;{}</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">, .{</span><span style="color:#005CC5;">@sizeOf</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Empty</span><span style="color:#24292E;">)});</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div></div></div><div class="info custom-block"><p class="custom-block-title">🅿️ 提示</p><p>使用 Go 的朋友对这个可能很熟悉，在 Go 中经常用空结构体做实体在 chan 中传递，它的内存大小为 0 ！</p></div><h2 id="通过字段获取基指针" tabindex="-1">通过字段获取基指针 <a class="header-anchor" href="#通过字段获取基指针" aria-label="Permalink to &quot;通过字段获取基指针&quot;">​</a></h2><p>为了获得最佳的性能，结构体字段的顺序是由编译器决定的，但是，我们可以仍然可以通过结构体字段的指针来获取到基指针！</p><div class="language-zig vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zig</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">Point</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">x</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">f32</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">y</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">f32</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setYBasedOnX</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">x</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">*f32</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">y</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">f32</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">point</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">@fieldParentPtr</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Point</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;x&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">x</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">point</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">y</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">y</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">Point</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">x</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">f32</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">y</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">f32</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setYBasedOnX</span><span style="color:#24292E;">(</span><span style="color:#E36209;">x</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">*f32</span><span style="color:#24292E;">, </span><span style="color:#E36209;">y</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">f32</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">point</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">@fieldParentPtr</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Point</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;x&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">x</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">point</span><span style="color:#24292E;">.</span><span style="color:#E36209;">y</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">y</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>这里使用了内置函数 <a href="https://ziglang.org/documentation/0.11.0/#toc-fieldParentPtr" target="_blank" rel="noreferrer"><code>@fieldParentPtr</code></a> ，它会根据给定字段指针，返回对应的结构体基指针。</p><h2 id="元组" tabindex="-1">元组 <a class="header-anchor" href="#元组" aria-label="Permalink to &quot;元组&quot;">​</a></h2><p>元组实际上就是不指定字段的匿名结构体。</p><p>由于没有字段名，zig 会为每个值分配一个整数的字段名，但是它无法通过正常的 <code>.</code> 语法来访问，但可以增加一个修饰符 <code>@&quot;&quot;</code>，通过它使用 <code>.</code> 语法访问元组中的元素。</p><div class="language-zig vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zig</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">values</span><span style="color:#E1E4E8;"> = .{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">@as</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">u32</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1234</span><span style="color:#E1E4E8;">),</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">@as</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">f64</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">12.34</span><span style="color:#E1E4E8;">),</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">true</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;hi&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">hi</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">values</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">@&quot;3&quot;</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">// &quot;hi&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">values</span><span style="color:#24292E;"> = .{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">@as</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">u32</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1234</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">@as</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">f64</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">12.34</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">true</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;hi&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">hi</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">values</span><span style="color:#24292E;">.</span><span style="color:#E36209;">@&quot;3&quot;</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">// &quot;hi&quot;</span></span></code></pre></div><p>当然，以上的语法很啰嗦,所以 zig 提供了类似数组的语法来访问元组，例如 <code>values[3]</code> 的值就是 &quot;hi&quot;。</p><div class="info custom-block"><p class="custom-block-title">🅿️ 提示</p><p>元组还有一个和数组一样的字段 <code>len</code>，并且支持 <code>++</code> 和 <code>**</code> 运算符，以及<a href="#">内联 for</a>。</p></div><h2 id="高级特性" tabindex="-1">高级特性 <a class="header-anchor" href="#高级特性" aria-label="Permalink to &quot;高级特性&quot;">​</a></h2><p>以下特性如果你连名字都没有听说过，那就代表你目前无需了解以下部分，待需要时再来学习即可！</p><blockquote><p>zig 并不保证结构体字段的顺序和结构体大小，但保证它是 ABI 对齐的。</p></blockquote><h3 id="extern" tabindex="-1">extern <a class="header-anchor" href="#extern" aria-label="Permalink to &quot;extern&quot;">​</a></h3><p><code>extern</code> 关键字用于修饰结构体，使其内存布局保证匹配对应目标的 C ABI。</p><p>这个关键字适合使用于嵌入式或者裸机器上，其他情况下建议使用 <code>packed</code> 或者普通结构体。</p><h3 id="packed" tabindex="-1">packed <a class="header-anchor" href="#packed" aria-label="Permalink to &quot;packed&quot;">​</a></h3><p><code>packed</code> 关键字修饰结构体，普通结构体不同，它保证了内存布局：</p><ul><li>字段严格按照声明的顺序排列</li><li>在不同字段之间不会存在位填充（不会发生内存对齐）</li><li>zig 支持任意位宽的整数（通常不足8位的仍然使用8位），但在 <code>packed</code> 下，会只使用它们的位宽</li><li><code>bool</code> 类型的字段，仅有一位</li><li>枚举类型只使用其整数标志位的位宽</li><li>联合类型只使用其最大位宽</li><li>根据目标的字节顺序，非 ABI 字段会被尽量压缩为占用尽可能小的 ABI 对齐整数的位宽。</li></ul><p>以上几个特性就有很多有意思的点值得我们使用和注意。</p><ol><li>zig 允许我们获取字段指针，但这些指针并不是普通指针（涉及到了位偏移），无法作为普通的函数参数使用，这个情况可以使用 <a href="https://ziglang.org/documentation/0.11.0/#bitOffsetOf" target="_blank" rel="noreferrer"><code>@bitOffsetOf</code></a> 和 <a href="https://ziglang.org/documentation/0.11.0/#offsetOf" target="_blank" rel="noreferrer"><code>@offsetOf</code></a> 观察到：</li></ol><details class="details custom-block"><summary>示例</summary><div class="language-zig vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zig</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">std</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">@import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;std&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">expect</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">std</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">testing</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">expect</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">BitField</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">packed</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">a</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">u3</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">b</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">u3</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">c</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">u2</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">test</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;pointer to non-bit-aligned field&quot;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">comptime</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">@bitOffsetOf</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">BitField</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;a&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">@bitOffsetOf</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">BitField</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;b&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">@bitOffsetOf</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">BitField</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;c&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">@offsetOf</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">BitField</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;a&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">@offsetOf</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">BitField</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;b&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">@offsetOf</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">BitField</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;c&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">std</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">@import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;std&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">expect</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">std</span><span style="color:#24292E;">.</span><span style="color:#E36209;">testing</span><span style="color:#24292E;">.</span><span style="color:#E36209;">expect</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">BitField</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">packed</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">a</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">u3</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">b</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">u3</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">c</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">u2</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">test</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;pointer to non-bit-aligned field&quot;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">comptime</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">@bitOffsetOf</span><span style="color:#24292E;">(</span><span style="color:#E36209;">BitField</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;a&quot;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">@bitOffsetOf</span><span style="color:#24292E;">(</span><span style="color:#E36209;">BitField</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;b&quot;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">@bitOffsetOf</span><span style="color:#24292E;">(</span><span style="color:#E36209;">BitField</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;c&quot;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">6</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">@offsetOf</span><span style="color:#24292E;">(</span><span style="color:#E36209;">BitField</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;a&quot;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">@offsetOf</span><span style="color:#24292E;">(</span><span style="color:#E36209;">BitField</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;b&quot;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">@offsetOf</span><span style="color:#24292E;">(</span><span style="color:#E36209;">BitField</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;c&quot;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div></details><ol start="2"><li>使用位转换 <a href="https://ziglang.org/documentation/0.11.0/#bitCast" target="_blank" rel="noreferrer"><code>@bitCast</code></a> 和指针转换 <a href="https://ziglang.org/documentation/0.11.0/#ptrCast" target="_blank" rel="noreferrer"><code>@ptrCast</code></a> 来强制对 <code>packed</code> 结构体进行转换操作：</li></ol><details class="details custom-block"><summary>示例</summary><div class="language-zig vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zig</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">std</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">@import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;std&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#6A737D;">// 这里获取目标架构是字节排序方式，大端和小端</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">native_endian</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">@import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;builtin&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#FFAB70;">target</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">cpu</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">arch</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">endian</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">expect</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">std</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">testing</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">expect</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">Full</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">packed</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">number</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">u16</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">Divided</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">packed</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">half1</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">quarter3</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">u4</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">quarter4</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">u4</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">test</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;@bitCast between packed structs&quot;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">doTheTest</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">comptime</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">doTheTest</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">doTheTest</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">!void</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">@sizeOf</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Full</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">@sizeOf</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Divided</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">full</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">Full</span><span style="color:#E1E4E8;">{ .</span><span style="color:#FFAB70;">number</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">0x1234</span><span style="color:#E1E4E8;"> };</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">divided</span><span style="color:#E1E4E8;">: </span><span style="color:#FFAB70;">Divided</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">@bitCast</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">full</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">divided</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">half1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0x34</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">divided</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">quarter3</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0x2</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">divided</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">quarter4</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0x1</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">ordered</span><span style="color:#E1E4E8;">: [</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">]</span><span style="color:#F97583;">u8</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">@bitCast</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">full</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">switch</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">native_endian</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#FFAB70;">Big</span><span style="color:#E1E4E8;"> =&gt; {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">ordered</span><span style="color:#E1E4E8;">[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0x12</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">ordered</span><span style="color:#E1E4E8;">[</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0x34</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        },</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#FFAB70;">Little</span><span style="color:#E1E4E8;"> =&gt; {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">ordered</span><span style="color:#E1E4E8;">[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0x34</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">ordered</span><span style="color:#E1E4E8;">[</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0x12</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        },</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">std</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">@import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;std&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">// 这里获取目标架构是字节排序方式，大端和小端</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">native_endian</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">@import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;builtin&quot;</span><span style="color:#24292E;">).</span><span style="color:#E36209;">target</span><span style="color:#24292E;">.</span><span style="color:#E36209;">cpu</span><span style="color:#24292E;">.</span><span style="color:#E36209;">arch</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">endian</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">expect</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">std</span><span style="color:#24292E;">.</span><span style="color:#E36209;">testing</span><span style="color:#24292E;">.</span><span style="color:#E36209;">expect</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">Full</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">packed</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">number</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">u16</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">};</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">Divided</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">packed</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">half1</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">u8</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">quarter3</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">u4</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">quarter4</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">u4</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">test</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;@bitCast between packed structs&quot;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">doTheTest</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">comptime</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">doTheTest</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">doTheTest</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">!void</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">@sizeOf</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Full</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">@sizeOf</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Divided</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">var</span><span style="color:#24292E;"> </span><span style="color:#E36209;">full</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">Full</span><span style="color:#24292E;">{ .</span><span style="color:#E36209;">number</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">0x1234</span><span style="color:#24292E;"> };</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">var</span><span style="color:#24292E;"> </span><span style="color:#E36209;">divided</span><span style="color:#24292E;">: </span><span style="color:#E36209;">Divided</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">@bitCast</span><span style="color:#24292E;">(</span><span style="color:#E36209;">full</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#E36209;">divided</span><span style="color:#24292E;">.</span><span style="color:#E36209;">half1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0x34</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#E36209;">divided</span><span style="color:#24292E;">.</span><span style="color:#E36209;">quarter3</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0x2</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#E36209;">divided</span><span style="color:#24292E;">.</span><span style="color:#E36209;">quarter4</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0x1</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">var</span><span style="color:#24292E;"> </span><span style="color:#E36209;">ordered</span><span style="color:#24292E;">: [</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">]</span><span style="color:#D73A49;">u8</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">@bitCast</span><span style="color:#24292E;">(</span><span style="color:#E36209;">full</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">switch</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">native_endian</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#E36209;">Big</span><span style="color:#24292E;"> =&gt; {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#E36209;">ordered</span><span style="color:#24292E;">[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0x12</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#E36209;">ordered</span><span style="color:#24292E;">[</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0x34</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        },</span></span>
<span class="line"><span style="color:#24292E;">        .</span><span style="color:#E36209;">Little</span><span style="color:#24292E;"> =&gt; {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#E36209;">ordered</span><span style="color:#24292E;">[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0x34</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#E36209;">ordered</span><span style="color:#24292E;">[</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0x12</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        },</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div></details><ol start="3"><li>还可以对 <code>packed</code> 的结构体的指针设置内存对齐来访问对应的字段：</li></ol><blockquote><p>这里说明可能有些不清楚，请见谅！</p></blockquote><div class="language-zig vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zig</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">std</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">@import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;std&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">expect</span><span style="color:#E1E4E8;"> = </span><span style="color:#FFAB70;">std</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">testing</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">expect</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">S</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">packed</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">a</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">u32</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">b</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">u32</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span>
<span class="line"><span style="color:#F97583;">test</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;overaligned pointer to packed struct&quot;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">foo</span><span style="color:#E1E4E8;">: </span><span style="color:#FFAB70;">S</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">align</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">) = .{ .</span><span style="color:#FFAB70;">a</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, .</span><span style="color:#FFAB70;">b</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> };</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">ptr</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">*align</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">) </span><span style="color:#FFAB70;">S</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">&amp;</span><span style="color:#FFAB70;">foo</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">ptr_to_b</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">*u32</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">&amp;</span><span style="color:#FFAB70;">ptr</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">b</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">ptr_to_b</span><span style="color:#E1E4E8;">.</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">std</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">@import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;std&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">expect</span><span style="color:#24292E;"> = </span><span style="color:#E36209;">std</span><span style="color:#24292E;">.</span><span style="color:#E36209;">testing</span><span style="color:#24292E;">.</span><span style="color:#E36209;">expect</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">S</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">packed</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">a</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">u32</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">b</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">u32</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">};</span></span>
<span class="line"><span style="color:#D73A49;">test</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;overaligned pointer to packed struct&quot;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">var</span><span style="color:#24292E;"> </span><span style="color:#E36209;">foo</span><span style="color:#24292E;">: </span><span style="color:#E36209;">S</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">align</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">4</span><span style="color:#24292E;">) = .{ .</span><span style="color:#E36209;">a</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, .</span><span style="color:#E36209;">b</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> };</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">ptr</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">*align</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">4</span><span style="color:#24292E;">) </span><span style="color:#E36209;">S</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">&amp;</span><span style="color:#E36209;">foo</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">ptr_to_b</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">*u32</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">&amp;</span><span style="color:#E36209;">ptr</span><span style="color:#24292E;">.</span><span style="color:#E36209;">b</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#E36209;">ptr_to_b</span><span style="color:#24292E;">.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="命名规则" tabindex="-1">命名规则 <a class="header-anchor" href="#命名规则" aria-label="Permalink to &quot;命名规则&quot;">​</a></h3><p>由于在 zig 中很多结构是匿名的（例如可以把一个源文件看作是一个匿名的结构体），所以 zig 基于一套规则来进行命名：</p><ul><li>如果一个结构体位于变量的初始化表达式中，它就以该变量命名（实际上就是声明结构体类型）。</li><li>如果一个结构体位于 <code>return</code> 表达式中，那么它以返回的函数命名，并序列化参数。</li><li>其他情况下，结构体会获得一个类似 <code>filename.funcname.__struct_ID</code> 的名字。</li><li>如果该结构体在另一个结构体中声明，它将以父结构体和前面的规则推断出的名称命名，并用点分隔。</li></ul><p>上面几条规则看着很模糊是吧，我们来几个小小的示例来演示一下：</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-VwvlO" id="tab-MTq3wx_" checked="checked"><label for="tab-MTq3wx_">default</label><input type="radio" name="group-VwvlO" id="tab-kUjJ-nw"><label for="tab-kUjJ-nw">output</label></div><div class="blocks"><div class="language-zig vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">zig</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">std</span><span style="color:#E1E4E8;"> = </span><span style="color:#79B8FF;">@import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;std&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">pub</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">Foo</span><span style="color:#E1E4E8;"> = </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {};</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">std</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">debug</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;variable: {s}</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">, .{</span><span style="color:#79B8FF;">@typeName</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Foo</span><span style="color:#E1E4E8;">)});</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">std</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">debug</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;anonymous: {s}</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">, .{</span><span style="color:#79B8FF;">@typeName</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {})});</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">std</span><span style="color:#E1E4E8;">.</span><span style="color:#FFAB70;">debug</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;function: {s}</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">, .{</span><span style="color:#79B8FF;">@typeName</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">List</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">i32</span><span style="color:#E1E4E8;">))});</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">List</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">comptime</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">T</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">type</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">type</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">x</span><span style="color:#E1E4E8;">: </span><span style="color:#FFAB70;">T</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    };</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">std</span><span style="color:#24292E;"> = </span><span style="color:#005CC5;">@import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;std&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">pub</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#E36209;">Foo</span><span style="color:#24292E;"> = </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {};</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">std</span><span style="color:#24292E;">.</span><span style="color:#E36209;">debug</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;variable: {s}</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">, .{</span><span style="color:#005CC5;">@typeName</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Foo</span><span style="color:#24292E;">)});</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">std</span><span style="color:#24292E;">.</span><span style="color:#E36209;">debug</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;anonymous: {s}</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">, .{</span><span style="color:#005CC5;">@typeName</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {})});</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">std</span><span style="color:#24292E;">.</span><span style="color:#E36209;">debug</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;function: {s}</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">, .{</span><span style="color:#005CC5;">@typeName</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">List</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">i32</span><span style="color:#24292E;">))});</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">List</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">comptime</span><span style="color:#24292E;"> </span><span style="color:#E36209;">T</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">type</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">type</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">x</span><span style="color:#24292E;">: </span><span style="color:#E36209;">T</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    };</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">variable:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">struct_name.main.Foo</span></span>
<span class="line"><span style="color:#B392F0;">anonymous:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">struct_name.main__struct_3509</span></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;">:</span><span style="color:#E1E4E8;"> struct_name.List(</span><span style="color:#B392F0;">i32</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">variable:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">struct_name.main.Foo</span></span>
<span class="line"><span style="color:#6F42C1;">anonymous:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">struct_name.main__struct_3509</span></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#6F42C1;">:</span><span style="color:#24292E;"> struct_name.List(</span><span style="color:#6F42C1;">i32</span><span style="color:#24292E;">)</span></span></code></pre></div></div></div>`,60),e=[o];function c(t,r,E,y,i,F){return n(),a("div",null,e)}const A=s(p,[["render",c]]);export{u as __pageData,A as default};
